<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Optimization-based control &mdash; Python Control Systems Library 0.10.1-8-gcc0020a documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="control.optimal.OptimalControlProblem" href="generated/control.optimal.OptimalControlProblem.html" />
    <link rel="prev" title="control.saturation_nonlinearity" href="generated/control.saturation_nonlinearity.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Python Control Systems Library
          </a>
              <div class="version">
                0.10.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Library conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">Function reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Control system classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab.html">MATLAB compatibility module</a></li>
<li class="toctree-l1"><a class="reference internal" href="flatsys.html">Differentially flat systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosys.html">Input/output systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="descfcn.html">Describing functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Optimization-based control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#optimal-control-problem-setup">Optimal control problem setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimal-estimation-problem-setup">Optimal estimation problem setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-usage">Module usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimization-tips">Optimization Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-classes-and-functions">Module classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.OptimalControlProblem.html">control.optimal.OptimalControlProblem</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.OptimalControlResult.html">control.optimal.OptimalControlResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.OptimalEstimationProblem.html">control.optimal.OptimalEstimationProblem</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.OptimalEstimationResult.html">control.optimal.OptimalEstimationResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.create_mpc_iosystem.html">control.optimal.create_mpc_iosystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.disturbance_range_constraint.html">control.optimal.disturbance_range_constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.gaussian_likelihood_cost.html">control.optimal.gaussian_likelihood_cost</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.input_poly_constraint.html">control.optimal.input_poly_constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.input_range_constraint.html">control.optimal.input_range_constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.output_poly_constraint.html">control.optimal.output_poly_constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.output_range_constraint.html">control.optimal.output_range_constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.quadratic_cost.html">control.optimal.quadratic_cost</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.solve_ocp.html">control.optimal.solve_ocp</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.state_poly_constraint.html">control.optimal.state_poly_constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/control.optimal.state_range_constraint.html">control.optimal.state_range_constraint</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python Control Systems Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Optimization-based control</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/optimal.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-control.optimal">
<span id="optimization-based-control"></span><span id="optimal-module"></span><h1>Optimization-based control<a class="headerlink" href="#module-control.optimal" title="Permalink to this heading">¶</a></h1>
<p>The <a class="reference internal" href="#module-control.optimal" title="control.optimal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">control.optimal</span></code></a> module provides support for optimization-based
controllers for nonlinear systems with state and input constraints.</p>
<p>The docstring examples assume that the following import commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">control</span> <span class="k">as</span> <span class="nn">ct</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">control.optimal</span> <span class="k">as</span> <span class="nn">obc</span>
</pre></div>
</div>
<div class="section" id="optimal-control-problem-setup">
<h2>Optimal control problem setup<a class="headerlink" href="#optimal-control-problem-setup" title="Permalink to this heading">¶</a></h2>
<p>Consider the <em>optimal control problem</em>:</p>
<div class="math">
<p><span class="math">\min_{u(\cdot)}
\int_0^T L(x,u)\, dt + V \bigl( x(T) \bigr)</span></p>
</div><p>subject to the constraint</p>
<div class="math">
<p><span class="math">\dot x = f(x, u), \qquad x\in\mathbb{R}^n,\, u\in\mathbb{R}^m.</span></p>
</div><p>Abstractly, this is a constrained optimization problem where we seek a
<em>feasible trajectory</em> <span class="math">(x(t), u(t))</span> that minimizes the cost function</p>
<div class="math">
<p><span class="math">J(x, u) = \int_0^T L(x, u)\, dt + V \bigl( x(T) \bigr).</span></p>
</div><p>More formally, this problem is equivalent to the “standard” problem of
minimizing a cost function <span class="math">J(x, u)</span> where <span class="math">(x, u) \in L_2[0,T]</span>
(the set of square integrable functions) and <span class="math">h(z) = \dot x(t) -
f(x(t), u(t)) = 0</span> models the dynamics.  The term <span class="math">L(x, u)</span> is
referred to as the integral (or trajectory) cost and <span class="math">V(x(T))</span> is the
final (or terminal) cost.</p>
<p>It is often convenient to ask that the final value of the trajectory,
denoted <span class="math">x_\text{f}</span>, be specified.  We can do this by requiring that
<span class="math">x(T) = x_\text{f}</span> or by using a more general form of constraint:</p>
<div class="math">
<p><span class="math">\psi_i(x(T)) = 0, \qquad i = 1, \dots, q.</span></p>
</div><p>The fully constrained case is obtained by setting <span class="math">q = n</span> and defining
<span class="math">\psi_i(x(T)) = x_i(T) - x_{i,\text{f}}</span>.  For a control problem with
a full set of terminal constraints, <span class="math">V(x(T))</span> can be omitted (since
its value is fixed).</p>
<p>Finally, we may wish to consider optimizations in which either the state or
the inputs are constrained by a set of nonlinear functions of the form</p>
<div class="math">
<p><span class="math">\text{lb}_i \leq g_i(x, u) \leq \text{ub}_i, \qquad i = 1, \dots, k.</span></p>
</div><p>where <span class="math">\text{lb}_i</span> and <span class="math">\text{ub}_i</span> represent lower and upper
bounds on the constraint function <span class="math">g_i</span>.  Note that these constraints
can be on the input, the state, or combinations of input and state,
depending on the form of <span class="math">g_i</span>.  Furthermore, these constraints are
intended to hold at all instants in time along the trajectory.</p>
<p>For a discrete time system, the same basic formulation applies except
that the cost function is given by</p>
<div class="math">
<p><span class="math">J(x, u) = \sum_{k=0}^{N-1} L(x_k, u_k)\, dt + V(x_N).</span></p>
</div><p>A common use of optimization-based control techniques is the implementation
of model predictive control (also called receding horizon control).  In
model predictive control, a finite horizon optimal control problem is solved,
generating open-loop state and control trajectories.  The resulting control
trajectory is applied to the system for a fraction of the horizon
length. This process is then repeated, resulting in a sampled data feedback
law.  This approach is illustrated in the following figure:</p>
<img alt="_images/mpc-overview.png" src="_images/mpc-overview.png" />
<p>Every <span class="math">\Delta T</span> seconds, an optimal control problem is solved over a
<span class="math">T</span> second horizon, starting from the current state.  The first
<span class="math">\Delta T</span> seconds of the optimal control <span class="math">u_T^{\*}(\cdot;
x(t))</span> is then applied to the system. If we let <span class="math">x_T^{\*}(\cdot;
x(t))</span> represent the optimal trajectory starting from <span class="math">x(t)</span> then the
system state evolves from <span class="math">x(t)</span> at current time <span class="math">t</span> to
<span class="math">x_T^{*}(\delta T, x(t))</span> at the next sample time <span class="math">t + \Delta
T</span>, assuming no model uncertainty.</p>
<p>In reality, the system will not follow the predicted path exactly, so that
the red (computed) and blue (actual) trajectories will diverge.  We thus
recompute the optimal path from the new state at time <span class="math">t + \Delta T</span>,
extending our horizon by an additional <span class="math">\Delta T</span> units of time.  This
approach can be shown to generate stabilizing control laws under suitable
conditions (see, for example, the FBS2e supplement on <a class="reference external" href="https://fbswiki.org/wiki/index.php/OBC">Optimization-Based
Control</a>.</p>
</div>
<div class="section" id="optimal-estimation-problem-setup">
<h2>Optimal estimation problem setup<a class="headerlink" href="#optimal-estimation-problem-setup" title="Permalink to this heading">¶</a></h2>
<p>Consider a nonlinear system with discrete time dynamics of the form</p>
<div class="math" id="equation-eq-fusion-nlsys-oep">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-eq-fusion-nlsys-oep" title="Permalink to this equation">¶</a></span><span class="math">X[k+1] = f(X[k], u[k], V[k]), \qquad Y[k] = h(X[k]) + W[k],</span></p>
</div><p>where <span class="math">X[k] \in \mathbb{R}^n</span>, <span class="math">u[k] \in \mathbb{R}^m</span>, and
<span class="math">Y[k] \in \mathbb{R}^p</span>, and <span class="math">V[k] \in \mathbb{R}^q</span> and
<span class="math">W[k] \in \mathbb{R}^p</span> represent random processes that are not
necessarily Gaussian white noise processes.  The estimation problem that we
wish to solve is to find the estimate <span class="math">\hat x[\cdot]</span> that matches
the measured outputs <span class="math">y[\cdot]</span> with “likely” disturbances and
noise.</p>
<p>For a fixed horizon of length <span class="math">N</span>, this problem can be formulated as
an optimization problem where we define the likelihood of a given estimate
(and the resulting noise and disturbances predicted by the model) as a cost
function. Suppose we model the likelihood using a conditional probability
density function <span class="math">p(x[0], \dots, x[N] \mid y[0], \dots, y[N-1])</span>.
Then we can pose the state estimation problem as</p>
<div class="math" id="equation-eq-fusion-oep">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-eq-fusion-oep" title="Permalink to this equation">¶</a></span><span class="math">\hat x[0], \dots, \hat x[N] =
\arg \max_{\hat x[0], \dots, \hat x[N]}
p(\hat x[0], \dots, \hat x[N] \mid y[0], \dots, y[N-1])</span></p>
</div><p>subject to the constraints given by equation <a class="reference internal" href="#equation-eq-fusion-nlsys-oep">(1)</a>.
The result of this optimization gives us the estimated state for the
previous <span class="math">N</span> steps in time, including the “current” time
<span class="math">x[N]</span>.  The basic idea is thus to compute the state estimate that is
most consistent with our model and penalize the noise and disturbances
according to how likely they are (based on the given stochastic system
model for each).</p>
<p>Given a solution to this fixed-horizon optimal estimation problem, we can
create an estimator for the state over all times by repeatedly applying the
optimization problem <a class="reference internal" href="#equation-eq-fusion-oep">(2)</a> over a moving horizon.  At each
time <span class="math">k</span>, we take the measurements for the last <span class="math">N</span> time steps
along with the previously estimated state at the start of the horizon,
<span class="math">x[k-N]</span> and reapply the optimization in equation
<a class="reference internal" href="#equation-eq-fusion-oep">(2)</a>.  This approach is known as a define{moving horizon
estimator} (MHE).</p>
<p>The formulation for the moving horizon estimation problem is very general
and various situations can be captured using the conditional probability
function <span class="math">p(x[0], \dots, x[N] \mid y[0], \dots, y[N-1]</span>.  We start by
noting that if the disturbances are independent of the underlying states of
the system, we can write the conditional probability as</p>
<div class="math">
<p><span class="math">p \bigl(x[0], \dots, x[N] \mid y[0], \dots, y[N-1]\bigr) =
p_{X[0]}(x[0])\, \prod_{k=0}^{N-1} p_V\bigl(y[k] - h(x[k])\bigr)\,
  p\bigl(x[k+1] \mid x[k]\bigr).</span></p>
</div><p>This expression can be further simplified by taking the log of the
expression and maximizing the function</p>
<div class="math" id="equation-eq-fusion-log-likelihood">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-eq-fusion-log-likelihood" title="Permalink to this equation">¶</a></span><span class="math">\log p_{X[0]}(x[0]) + \sum_{k=0}^{N-1} \log
p_W \bigl(y[k] - h(x[k])\bigr) + \log p_V(v[k]).</span></p>
</div><p>The first term represents the likelihood of the initial state, the
second term captures the likelihood of the noise signal, and the final
term captures the likelihood of the disturbances.</p>
<p>If we return to the case where <span class="math">V</span> and <span class="math">W</span> are modeled as
Gaussian processes, then it can be shown that maximizing equation
<a class="reference internal" href="#equation-eq-fusion-log-likelihood">(3)</a> is equivalent to solving the optimization
problem given by</p>
<div class="math" id="equation-eq-fusion-oep-gaussian">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-eq-fusion-oep-gaussian" title="Permalink to this equation">¶</a></span><span class="math">\min_{x[0], \{v[0], \dots, v[N-1]\}}
\|x[0] - \bar x[0]\|_{P_0^{-1}} + \sum_{k=0}^{N-1}
\|y[k] - h(x_k)\|_{R_W^{-1}}^2 +
\|v[k] \|_{R_V^{-1}}^2,</span></p>
</div><p>where <span class="math">P_0</span>, <span class="math">R_V</span>, and <span class="math">R_W</span> are the covariances of the
initial state, disturbances, and measurement noise.</p>
<p>Note that while the optimization is carried out only over the estimated
initial state <span class="math">\hat x[0]</span>, the entire history of estimated states can
be reconstructed using the system dynamics:</p>
<div class="math">
<p><span class="math">\hat x[k+1] = f(\hat x[k], u[k], v[k]), \quad k = 0, \dots, N-1.</span></p>
</div><p>In particular, we can obtain the estimated state at the end of the moving
horizon window, corresponding to the current time, and we can thus
implement an estimator by repeatedly solving the optimization of a window
of length <span class="math">N</span> backwards in time.</p>
</div>
<div class="section" id="module-usage">
<h2>Module usage<a class="headerlink" href="#module-usage" title="Permalink to this heading">¶</a></h2>
<p>The optimization-based control module provides a means of computing
optimal trajectories for nonlinear systems and implementing
optimization-based controllers, including model predictive control and
moving horizon estimation.  It follows the basic problem setups
described above, but carries out all computations in <em>discrete time</em>
(so that integrals become sums) and over a <em>finite horizon</em>.  To local
the optimal control modules, import <cite>control.optimal</cite>:</p>
<blockquote>
<div><p>import control.optimal as obc</p>
</div></blockquote>
<p>To describe an optimal control problem we need an input/output system, a
time horizon, a cost function, and (optionally) a set of constraints on the
state and/or input, either along the trajectory and at the terminal time.
The optimal control module operates by converting the optimal control
problem into a standard optimization problem that can be solved by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a>.  The optimal control problem can be solved
by using the <a class="reference internal" href="generated/control.optimal.solve_ocp.html#control.optimal.solve_ocp" title="control.optimal.solve_ocp"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_ocp()</span></code></a> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">solve_ocp</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">timepts</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>sys</cite> parameter should be an <a class="reference internal" href="generated/control.InputOutputSystem.html#control.InputOutputSystem" title="control.InputOutputSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputOutputSystem</span></code></a> and the
<cite>timepts</cite> parameter should represent a time vector that gives the list of
times at which the cost and constraints should be evaluated.</p>
<p>The <cite>cost</cite> function has call signature <cite>cost(t, x, u)</cite> and should return the
(incremental) cost at the given time, state, and input.  It will be
evaluated at each point in the <cite>timepts</cite> vector.  The <cite>terminal_cost</cite>
parameter can be used to specify a cost function for the final point in the
trajectory.</p>
<p>The <cite>constraints</cite> parameter is a list of constraints similar to that used by
the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a> function.  Each constraint is specified
using one of the following forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LinearConstraint</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
<span class="n">NonlinearConstraint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
</pre></div>
</div>
<p>For a linear constraint, the 2D array <cite>A</cite> is multiplied by a vector
consisting of the current state <cite>x</cite> and current input <cite>u</cite> stacked
vertically, then compared with the upper and lower bound.  This constraint
is satisfied if</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lb</span> <span class="o">&lt;=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">ub</span>
</pre></div>
</div>
<p>A nonlinear constraint is satisfied if</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lb</span> <span class="o">&lt;=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ub</span>
</pre></div>
</div>
<p>By default, <cite>constraints</cite> are taken to be trajectory constraints holding at
all points on the trajectory.  The <cite>terminal_constraint</cite> parameter can be
used to specify a constraint that only holds at the final point of the
trajectory.</p>
<p>The return value for <a class="reference internal" href="generated/control.optimal.solve_ocp.html#control.optimal.solve_ocp" title="control.optimal.solve_ocp"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_ocp()</span></code></a> is a bundle object
that has the following elements:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>res.success</cite>: <cite>True</cite> if the optimization was successfully solved</p></li>
<li><p><cite>res.inputs</cite>: optimal input</p></li>
<li><p><cite>res.states</cite>: state trajectory (if <cite>return_x</cite> was <cite>True</cite>)</p></li>
<li><p><cite>res.time</cite>: copy of the time timepts vector</p></li>
</ul>
</div></blockquote>
<p>In addition, the results from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a> are also
available.</p>
<p>To simplify the specification of cost functions and constraints, the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">ios</span></code> module defines a number of utility functions for
optimal control problems:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.quadratic_cost.html#control.optimal.quadratic_cost" title="control.optimal.quadratic_cost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quadratic_cost</span></code></a>(sys, Q, R[, x0, u0])</p></td>
<td><p>Create quadratic cost function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.input_poly_constraint.html#control.optimal.input_poly_constraint" title="control.optimal.input_poly_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_poly_constraint</span></code></a>(sys, A, b)</p></td>
<td><p>Create input constraint from polytope</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.input_range_constraint.html#control.optimal.input_range_constraint" title="control.optimal.input_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create input constraint from polytope</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.output_poly_constraint.html#control.optimal.output_poly_constraint" title="control.optimal.output_poly_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_poly_constraint</span></code></a>(sys, A, b)</p></td>
<td><p>Create output constraint from polytope</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.output_range_constraint.html#control.optimal.output_range_constraint" title="control.optimal.output_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create output constraint from range</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.state_poly_constraint.html#control.optimal.state_poly_constraint" title="control.optimal.state_poly_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_poly_constraint</span></code></a>(sys, A, b)</p></td>
<td><p>Create state constraint from polytope</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.state_range_constraint.html#control.optimal.state_range_constraint" title="control.optimal.state_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create state constraint from range</p></td>
</tr>
</tbody>
</table>
<p>The optimization-based control module also implements functions for solving
optimal estimation problems.  The
<a class="reference internal" href="generated/control.optimal.OptimalEstimationProblem.html#control.optimal.OptimalEstimationProblem" title="control.optimal.OptimalEstimationProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimalEstimationProblem</span></code></a> class is used to define
an optimal estimation problem over a finite horizon:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oep</span> <span class="o">=</span> <span class="n">OptimalEstimationProblem</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">timepts</span><span class="p">,</span> <span class="n">cost</span><span class="p">[,</span> <span class="n">constraints</span><span class="p">])</span>
</pre></div>
</div>
<p>Given noisy measurements <span class="math">y</span> and control inputs <span class="math">u</span>, an
estimate of the states over the time points can be computed using the
<a class="reference internal" href="generated/control.optimal.OptimalEstimationProblem.html#control.optimal.OptimalEstimationProblem.compute_estimate" title="control.optimal.OptimalEstimationProblem.compute_estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_estimate()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estim</span> <span class="o">=</span> <span class="n">oep</span><span class="o">.</span><span class="n">compute_optimal</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">[,</span> <span class="n">X0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="p">(</span><span class="n">xhat</span><span class="p">,</span> <span class="n">v</span><span class="p">)])</span>
<span class="n">xhat</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">estim</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">estim</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">estim</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>
</div>
<p>For discrete time systems, the
<a class="reference internal" href="generated/control.optimal.OptimalEstimationProblem.html#control.optimal.OptimalEstimationProblem.create_mhe_iosystem" title="control.optimal.OptimalEstimationProblem.create_mhe_iosystem"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_mhe_iosystem()</span></code></a>
method can be used to generate an input/output system that implements a
moving horizon estimator.</p>
<p>Several functions are available to help set up standard optimal estimation
problems:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.gaussian_likelihood_cost.html#control.optimal.gaussian_likelihood_cost" title="control.optimal.gaussian_likelihood_cost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_likelihood_cost</span></code></a>(sys, Rv[, Rw])</p></td>
<td><p>Create cost function for Gaussian likelihoods</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.disturbance_range_constraint.html#control.optimal.disturbance_range_constraint" title="control.optimal.disturbance_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disturbance_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create constraint for bounded disturbances</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>Consider the vehicle steering example described in FBS2e.  The dynamics of
the system can be defined as a nonlinear input/output system using the
following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">control</span> <span class="k">as</span> <span class="nn">ct</span>
<span class="kn">import</span> <span class="nn">control.optimal</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">vehicle_update</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="c1"># Get the parameters for the model</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wheelbase&#39;</span><span class="p">,</span> <span class="mf">3.</span><span class="p">)</span>         <span class="c1"># vehicle wheelbase</span>
    <span class="n">phimax</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maxsteer&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>    <span class="c1"># max steering angle (rad)</span>

    <span class="c1"># Saturate the steering input</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">phimax</span><span class="p">,</span> <span class="n">phimax</span><span class="p">)</span>

    <span class="c1"># Return the derivative of the state</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>            <span class="c1"># xdot = cos(theta) v</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>            <span class="c1"># ydot = sin(theta) v</span>
        <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>        <span class="c1"># thdot = v/l tan(phi)</span>
    <span class="p">])</span>

<span class="k">def</span> <span class="nf">vehicle_output</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span>                            <span class="c1"># return x, y, theta (full state)</span>

<span class="c1"># Define the vehicle steering dynamics as an input/output system</span>
<span class="n">vehicle</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">NonlinearIOSystem</span><span class="p">(</span>
    <span class="n">vehicle_update</span><span class="p">,</span> <span class="n">vehicle_output</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vehicle&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">),</span> <span class="n">outputs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;theta&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We consider an optimal control problem that consists of “changing lanes” by
moving from the point x = 0 m, y = -2 m, <span class="math">\theta</span> = 0 to the point x =
100 m, y = 2 m, <span class="math">\theta</span> = 0) over a period of 10 seconds and
with a starting and ending velocity of 10 m/s:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]);</span> <span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]);</span> <span class="n">uf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">Tf</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
<p>To set up the optimal control problem we design a cost function that
penalizes the state and input using quadratic cost functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>          <span class="c1"># don&#39;t turn too sharply</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>               <span class="c1"># keep inputs small</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>   <span class="c1"># get close to final point</span>
<span class="n">traj_cost</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">quadratic_cost</span><span class="p">(</span><span class="n">vehicle</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">xf</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="n">uf</span><span class="p">)</span>
<span class="n">term_cost</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">quadratic_cost</span><span class="p">(</span><span class="n">vehicle</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">xf</span><span class="p">)</span>
</pre></div>
</div>
<p>We also constrain the maximum turning rate to 0.1 radians (about 6 degrees)
and constrain the velocity to be in the range of 9 m/s to 11 m/s:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span> <span class="n">obc</span><span class="o">.</span><span class="n">input_range_constraint</span><span class="p">(</span><span class="n">vehicle</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span> <span class="p">]</span>
</pre></div>
</div>
<p>Finally, we solve for the optimal inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timepts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tf</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">solve_ocp</span><span class="p">(</span>
    <span class="n">vehicle</span><span class="p">,</span> <span class="n">timepts</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">traj_cost</span><span class="p">,</span> <span class="n">constraints</span><span class="p">,</span>
    <span class="n">terminal_cost</span><span class="o">=</span><span class="n">term_cost</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="n">u0</span><span class="p">)</span>
</pre></div>
</div>
<p>Plotting the results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate the system dynamics (open loop)</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">input_output_response</span><span class="p">(</span>
    <span class="n">vehicle</span><span class="p">,</span> <span class="n">timepts</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span>
    <span class="n">t_eval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tf</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">inputs</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">xf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x [m]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y [m]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">9.9</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t [sec]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;u1 [m/s]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t [sec]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;u2 [rad/s]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Lane change manuever&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>yields</p>
<img alt="_images/steering-optimal.png" src="_images/steering-optimal.png" />
<p>An example showing the use of the optimal estimation problem and moving
horizon estimation (MHE) is given in the <a class="reference internal" href="mhe-pvtol.html"><span class="doc">mhe-pvtol Jupyter
notebook</span></a>.</p>
</div>
<div class="section" id="optimization-tips">
<h2>Optimization Tips<a class="headerlink" href="#optimization-tips" title="Permalink to this heading">¶</a></h2>
<p>The python-control optimization module makes use of the SciPy optimization
toolbox and it can sometimes be tricky to get the optimization to converge.
If you are getting errors when solving optimal control problems or your
solutions do not seem close to optimal, here are a few things to try:</p>
<ul class="simple">
<li><p>The initial guess matters: providing a reasonable initial guess is often
needed in order for the optimizer to find a good answer.  For an optimal
control problem that uses a larger terminal cost to get to a neighborhood
of a final point, a straight line in the state space often works well.</p></li>
<li><p>Less is more: try using a smaller number of time points in your
optimization.  The default optimal control problem formulation uses the
value of the inputs at each time point as a free variable and this can
generate a large number of parameters quickly.  Often you can find very
good solutions with a small number of free variables (the example above
uses 3 time points for 2 inputs, so a total of 6 optimization variables).
Note that you can “resample” the optimal trajectory by running a
simulation of the system and using the <cite>t_eval</cite> keyword in
<cite>input_output_response</cite> (as done above).</p></li>
<li><p>Use a smooth basis: as an alternative to parameterizing the optimal
control inputs using the value of the control at the listed time points,
you can specify a set of basis functions using the <cite>basis</cite> keyword in
<code class="xref py py-func docutils literal notranslate"><span class="pre">solve_ocp()</span></code> and then parameterize the controller by linear
combination of the basis functions.  The <code class="xref py py-mod docutils literal notranslate"><span class="pre">control.flatsys</span></code> module
defines several sets of basis functions that can be used.</p></li>
<li><p>Tweak the optimizer: by using the <cite>minimize_method</cite>, <cite>minimize_options</cite>,
and <cite>minimize_kwargs</cite> keywords in <code class="xref py py-func docutils literal notranslate"><span class="pre">solve_ocp()</span></code>, you can
choose the SciPy optimization function that you use and set many
parameters.  See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a> for more information on
the optimizers that are available and the options and keywords that they
accept.</p></li>
<li><p>Walk before you run: try setting up a simpler version of the optimization,
remove constraints or simplifying the cost to get a simple version of the
problem working and then add complexity.  Sometimes this can help you find
the right set of options or identify situations in which you are being too
aggressive in what you are trying to get the system to do.</p></li>
</ul>
<p>See <a class="reference internal" href="steering-optimal.html#steering-optimal"><span class="std std-ref">Optimal control for vehicle steering (lane change)</span></a> for some examples of different problem
formulations.</p>
</div>
<div class="section" id="module-classes-and-functions">
<h2>Module classes and functions<a class="headerlink" href="#module-classes-and-functions" title="Permalink to this heading">¶</a></h2>
<p>The following classes and functions are defined in the
<code class="docutils literal notranslate"><span class="pre">optimal</span></code> module:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.OptimalControlProblem.html#control.optimal.OptimalControlProblem" title="control.optimal.OptimalControlProblem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimalControlProblem</span></code></a>(sys, timepts, ...[, ...])</p></td>
<td><p>Description of a finite horizon, optimal control problem.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.OptimalControlResult.html#control.optimal.OptimalControlResult" title="control.optimal.OptimalControlResult"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimalControlResult</span></code></a>(ocp, res[, ...])</p></td>
<td><p>Result from solving an optimal control problem.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.OptimalEstimationProblem.html#control.optimal.OptimalEstimationProblem" title="control.optimal.OptimalEstimationProblem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimalEstimationProblem</span></code></a>(sys, timepts, ...)</p></td>
<td><p>Description of a finite horizon, optimal estimation problem.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.OptimalEstimationResult.html#control.optimal.OptimalEstimationResult" title="control.optimal.OptimalEstimationResult"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OptimalEstimationResult</span></code></a>(oep, res[, ...])</p></td>
<td><p>Result from solving an optimal estimationproblem.</p></td>
</tr>
</tbody>
</table>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.create_mpc_iosystem.html#control.optimal.create_mpc_iosystem" title="control.optimal.create_mpc_iosystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_mpc_iosystem</span></code></a>(sys, timepts, cost[, ...])</p></td>
<td><p>Create a model predictive I/O control system</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.disturbance_range_constraint.html#control.optimal.disturbance_range_constraint" title="control.optimal.disturbance_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disturbance_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create constraint for bounded disturbances</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.gaussian_likelihood_cost.html#control.optimal.gaussian_likelihood_cost" title="control.optimal.gaussian_likelihood_cost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian_likelihood_cost</span></code></a>(sys, Rv[, Rw])</p></td>
<td><p>Create cost function for Gaussian likelihoods</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.input_poly_constraint.html#control.optimal.input_poly_constraint" title="control.optimal.input_poly_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_poly_constraint</span></code></a>(sys, A, b)</p></td>
<td><p>Create input constraint from polytope</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.input_range_constraint.html#control.optimal.input_range_constraint" title="control.optimal.input_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create input constraint from polytope</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.output_poly_constraint.html#control.optimal.output_poly_constraint" title="control.optimal.output_poly_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_poly_constraint</span></code></a>(sys, A, b)</p></td>
<td><p>Create output constraint from polytope</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.output_range_constraint.html#control.optimal.output_range_constraint" title="control.optimal.output_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create output constraint from range</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.quadratic_cost.html#control.optimal.quadratic_cost" title="control.optimal.quadratic_cost"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quadratic_cost</span></code></a>(sys, Q, R[, x0, u0])</p></td>
<td><p>Create quadratic cost function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.solve_ocp.html#control.optimal.solve_ocp" title="control.optimal.solve_ocp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_ocp</span></code></a>(sys, timepts, X0, cost[, ...])</p></td>
<td><p>Compute the solution to an optimal control problem.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/control.optimal.state_poly_constraint.html#control.optimal.state_poly_constraint" title="control.optimal.state_poly_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_poly_constraint</span></code></a>(sys, A, b)</p></td>
<td><p>Create state constraint from polytope</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/control.optimal.state_range_constraint.html#control.optimal.state_range_constraint" title="control.optimal.state_range_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_range_constraint</span></code></a>(sys, lb, ub)</p></td>
<td><p>Create state constraint from range</p></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="generated/control.saturation_nonlinearity.html" class="btn btn-neutral float-left" title="control.saturation_nonlinearity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="generated/control.optimal.OptimalControlProblem.html" class="btn btn-neutral float-right" title="control.optimal.OptimalControlProblem" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, python-control.org.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>